package common.util;

import java.io.File;
import java.util.Date;

import javax.servlet.http.HttpServletRequest;

import com.oreilly.servlet.MultipartRequest;
import com.oreilly.servlet.multipart.DefaultFileRenamePolicy;

import common.vo.UploadFile;

public class FileUtil {

	public UploadFile fileUpload(String uploadFolder, HttpServletRequest request) {
		UploadFile uf = new UploadFile();

		int maxSize = 1024 * 1024 * 10;

		String originFileName = "";

		String renameFileName = "";

		String root = request.getServletContext().getRealPath("/");

		String savePath = root + uploadFolder;
		
		//request를 MultipartRequest로 교체
				//MultipartRequest 객체가 생성됨과 동시에 파일 업로드가 이루어 진다.
				MultipartRequest mrequest = new MultipartRequest(request, savePath, maxSize, "UTF-8",
						new DefaultFileRenamePolicy());

				originFileName = mrequest.getFilesystemName("noticeFile");
				if (originFileName != null) {
					String fileName = String.valueOf(new Date().getTime());

					renameFileName = fileName + originFileName.substring(originFileName.lastIndexOf("."));

					File originFile = new File(savePath + "\\" + originFileName);
					File renameFile = new File(savePath + "\\" + renameFileName);

					originFile.renameTo(renameFile);
				}

		return uf;
	}

}
